<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Global Tax Calculator Map</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        h1 {
            text-align: center;
            color: white;
            margin-bottom: 30px;
            font-size: 2.5rem;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .calculator-section {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .input-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .input-field {
            display: flex;
            flex-direction: column;
        }

        label {
            font-weight: 600;
            margin-bottom: 8px;
            color: #555;
        }

        input, select {
            padding: 12px;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        input:focus, select:focus {
            outline: none;
            border-color: #667eea;
        }

        .calculate-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .calculate-btn:hover {
            transform: translateY(-2px);
        }

        .results {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .result-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            border-left: 5px solid #667eea;
        }

        .result-card h3 {
            color: #667eea;
            margin-bottom: 10px;
        }

        .result-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: #333;
        }

        .map-container {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            overflow: hidden;
        }

        .world-map {
            width: 100%;
            height: 500px;
            background: #f0f8ff;
            border-radius: 10px;
            position: relative;
            overflow: auto;
        }

        .country {
            cursor: pointer;
            transition: all 0.3s;
        }

        .country:hover {
            stroke: #667eea;
            stroke-width: 2px;
        }

        .country.selected {
            fill: #667eea !important;
            stroke: #333;
            stroke-width: 2px;
        }

        .country-info {
            position: absolute;
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 10px;
            border-radius: 5px;
            font-size: 12px;
            pointer-events: none;
            z-index: 1000;
            display: none;
        }

        .tax-legend {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .legend-color {
            width: 20px;
            height: 15px;
            border-radius: 3px;
        }

        .disclaimer {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 8px;
            padding: 15px;
            margin-top: 20px;
            font-size: 14px;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .input-group {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üåç Global Tax Calculator Map</h1>
        
        <div class="calculator-section">
            <h2>üí∞ Calculate Your Annual Tax Burden</h2>
            
            <div class="input-group">
                <div class="input-field">
                    <label for="salary">Monthly Salary (Local Currency)</label>
                    <input type="number" id="salary" placeholder="Enter your monthly salary" value="5000">
                </div>
                
                <div class="input-field">
                    <label for="country">Select Country</label>
                    <select id="country">
                        <option value="">Choose a country...</option>
                    </select>
                </div>
                
                <div class="input-field">
                    <label for="currency">Currency</label>
                    <input type="text" id="currency" placeholder="Currency" readonly>
                </div>
            </div>
            
            <button class="calculate-btn" onclick="calculateTax()">Calculate Tax üßÆ</button>
            
            <div class="results" id="results" style="display: none;">
                <div class="result-card">
                    <h3>Annual Gross Income</h3>
                    <div class="result-value" id="grossIncome">-</div>
                </div>
                
                <div class="result-card">
                    <h3>Annual Tax Amount</h3>
                    <div class="result-value" id="taxAmount">-</div>
                </div>
                
                <div class="result-card">
                    <h3>Effective Tax Rate</h3>
                    <div class="result-value" id="taxRate">-</div>
                </div>
                
                <div class="result-card">
                    <h3>Net Annual Income</h3>
                    <div class="result-value" id="netIncome">-</div>
                </div>
            </div>
        </div>
        
        <div class="map-container">
            <h2>üó∫Ô∏è Interactive Tax Rates Map</h2>
            <p>Click on countries to select them for calculation. Colors represent top tax rates.</p>
            
            <div class="world-map" id="worldMap">
                <svg width="100%" height="100%" viewBox="0 0 1000 500">
                    <!-- Simplified world map with major countries -->
                    <!-- North America -->
                    <path class="country" data-country="united_states" d="M100 150 L300 150 L300 250 L100 250 Z" fill="#ff6b6b" stroke="#333" stroke-width="1"/>
                    <text x="200" y="200" text-anchor="middle" font-size="12" font-weight="bold">USA</text>
                    
                    <path class="country" data-country="canada" d="M100 100 L300 100 L300 150 L100 150 Z" fill="#ff8e53" stroke="#333" stroke-width="1"/>
                    <text x="200" y="130" text-anchor="middle" font-size="12" font-weight="bold">Canada</text>
                    
                    <path class="country" data-country="mexico" d="M100 250 L250 250 L250 300 L100 300 Z" fill="#ff6b6b" stroke="#333" stroke-width="1"/>
                    <text x="175" y="280" text-anchor="middle" font-size="11" font-weight="bold">Mexico</text>
                    
                    <!-- South America -->
                    <path class="country" data-country="brazil" d="M200 320 L350 320 L350 450 L200 450 Z" fill="#ff8e53" stroke="#333" stroke-width="1"/>
                    <text x="275" y="390" text-anchor="middle" font-size="12" font-weight="bold">Brazil</text>
                    
                    <path class="country" data-country="argentina" d="M180 400 L250 400 L250 480 L180 480 Z" fill="#ff8e53" stroke="#333" stroke-width="1"/>
                    <text x="215" y="445" text-anchor="middle" font-size="10" font-weight="bold">Argentina</text>
                    
                    <!-- Europe -->
                    <path class="country" data-country="united_kingdom" d="M450 120 L490 120 L490 160 L450 160 Z" fill="#ee5a6f" stroke="#333" stroke-width="1"/>
                    <text x="470" y="145" text-anchor="middle" font-size="9" font-weight="bold">UK</text>
                    
                    <path class="country" data-country="france" d="M490 140 L530 140 L530 180 L490 180 Z" fill="#ee5a6f" stroke="#333" stroke-width="1"/>
                    <text x="510" y="165" text-anchor="middle" font-size="10" font-weight="bold">France</text>
                    
                    <path class="country" data-country="germany" d="M520 120 L560 120 L560 160 L520 160 Z" fill="#ee5a6f" stroke="#333" stroke-width="1"/>
                    <text x="540" y="145" text-anchor="middle" font-size="10" font-weight="bold">Germany</text>
                    
                    <path class="country" data-country="spain" d="M480 180 L520 180 L520 220 L480 220 Z" fill="#ff8e53" stroke="#333" stroke-width="1"/>
                    <text x="500" y="205" text-anchor="middle" font-size="10" font-weight="bold">Spain</text>
                    
                    <path class="country" data-country="italy" d="M520 180 L550 180 L550 230 L520 230 Z" fill="#ff8e53" stroke="#333" stroke-width="1"/>
                    <text x="535" y="210" text-anchor="middle" font-size="10" font-weight="bold">Italy</text>
                    
                    <path class="country" data-country="sweden" d="M540 80 L570 80 L570 120 L540 120 Z" fill="#cc2a41" stroke="#333" stroke-width="1"/>
                    <text x="555" y="105" text-anchor="middle" font-size="10" font-weight="bold">Sweden</text>
                    
                    <path class="country" data-country="norway" d="M510 70 L540 70 L540 120 L510 120 Z" fill="#cc2a41" stroke="#333" stroke-width="1"/>
                    <text x="525" y="100" text-anchor="middle" font-size="9" font-weight="bold">Norway</text>
                    
                    <path class="country" data-country="denmark" d="M540 100 L570 100 L570 120 L540 120 Z" fill="#a61e1e" stroke="#333" stroke-width="1"/>
                    <text x="555" y="115" text-anchor="middle" font-size="9" font-weight="bold">Denmark</text>
                    
                    <!-- Russia -->
                    <path class="country" data-country="russia" d="M580 80 L800 80 L800 180 L580 180 Z" fill="#ff8e53" stroke="#333" stroke-width="1"/>
                    <text x="690" y="135" text-anchor="middle" font-size="14" font-weight="bold">Russia</text>
                    
                    <!-- Asia -->
                    <path class="country" data-country="china" d="M700 180 L850 180 L850 280 L700 280 Z" fill="#ff8e53" stroke="#333" stroke-width="1"/>
                    <text x="775" y="235" text-anchor="middle" font-size="14" font-weight="bold">China</text>
                    
                    <path class="country" data-country="india" d="M650 250 L750 250 L750 350 L650 350 Z" fill="#ff8e53" stroke="#333" stroke-width="1"/>
                    <text x="700" y="305" text-anchor="middle" font-size="12" font-weight="bold">India</text>
                    
                    <path class="country" data-country="japan" d="M860 200 L920 200 L920 260 L860 260 Z" fill="#ff8e53" stroke="#333" stroke-width="1"/>
                    <text x="890" y="235" text-anchor="middle" font-size="11" font-weight="bold">Japan</text>
                    
                    <path class="country" data-country="south_korea" d="M850 220 L880 220 L880 250 L850 250 Z" fill="#ff8e53" stroke="#333" stroke-width="1"/>
                    <text x="865" y="240" text-anchor="middle" font-size="9" font-weight="bold">S.Korea</text>
                    
                    <!-- Southeast Asia -->
                    <path class="country" data-country="indonesia" d="M750 320 L850 320 L850 380 L750 380 Z" fill="#ff8e53" stroke="#333" stroke-width="1"/>
                    <text x="800" y="355" text-anchor="middle" font-size="11" font-weight="bold">Indonesia</text>
                    
                    <path class="country" data-country="thailand" d="M720 280 L760 280 L760 320 L720 320 Z" fill="#ff8e53" stroke="#333" stroke-width="1"/>
                    <text x="740" y="305" text-anchor="middle" font-size="9" font-weight="bold">Thailand</text>
                    
                    <path class="country" data-country="singapore" d="M760 310 L780 310 L780 325 L760 325 Z" fill="#4ecdc4" stroke="#333" stroke-width="1"/>
                    <text x="770" y="322" text-anchor="middle" font-size="8" font-weight="bold">Singapore</text>
                    
                    <!-- Australia -->
                    <path class="country" data-country="australia" d="M750 400 L900 400 L900 480 L750 480 Z" fill="#ff8e53" stroke="#333" stroke-width="1"/>
                    <text x="825" y="445" text-anchor="middle" font-size="14" font-weight="bold">Australia</text>
                    
                    <!-- Africa -->
                    <path class="country" data-country="south_africa" d="M520 380 L580 380 L580 450 L520 450 Z" fill="#ff8e53" stroke="#333" stroke-width="1"/>
                    <text x="550" y="420" text-anchor="middle" font-size="10" font-weight="bold">S.Africa</text>
                    
                    <path class="country" data-country="nigeria" d="M480 300 L520 300 L520 340 L480 340 Z" fill="#4ecdc4" stroke="#333" stroke-width="1"/>
                    <text x="500" y="325" text-anchor="middle" font-size="10" font-weight="bold">Nigeria</text>
                    
                    <path class="country" data-country="egypt" d="M540 250 L580 250 L580 290 L540 290 Z" fill="#ff8e53" stroke="#333" stroke-width="1"/>
                    <text x="560" y="275" text-anchor="middle" font-size="10" font-weight="bold">Egypt</text>
                    
                    <!-- Middle East -->
                    <path class="country" data-country="saudi_arabia" d="M580 280 L630 280 L630 320 L580 320 Z" fill="#45b7d1" stroke="#333" stroke-width="1"/>
                    <text x="605" y="305" text-anchor="middle" font-size="9" font-weight="bold">Saudi Arabia</text>
                    
                    <path class="country" data-country="united_arab_emirates" d="M630 300 L660 300 L660 320 L630 320 Z" fill="#45b7d1" stroke="#333" stroke-width="1"/>
                    <text x="645" y="315" text-anchor="middle" font-size="8" font-weight="bold">UAE</text>
                </svg>
                
                <div class="country-info" id="countryInfo"></div>
            </div>
            
            <div class="tax-legend">
                <div class="legend-item">
                    <div class="legend-color" style="background-color: #45b7d1;"></div>
                    <span>0% (Tax Haven)</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background-color: #4ecdc4;"></div>
                    <span>1-20% (Low)</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background-color: #ff8e53;"></div>
                    <span>21-40% (Medium)</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background-color: #ff6b6b;"></div>
                    <span>41-50% (High)</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background-color: #ee5a6f;"></div>
                    <span>51-55% (Very High)</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background-color: #cc2a41;"></div>
                    <span>55%+ (Highest)</span>
                </div>
            </div>
        </div>
        
        <div class="disclaimer">
            <strong>üìå Disclaimer:</strong> This calculator provides estimates based on basic income tax brackets for 2024-2025. 
            Actual taxes may vary due to deductions, credits, social security contributions, municipal taxes, and other factors. 
            Consult a tax professional for accurate calculations. Data covers 146+ countries with progressive, flat, and zero-tax systems.
        </div>
    </div>

    <script>
        // Tax data for major countries (simplified from our comprehensive database)
        const taxData = {
            "united_states": {
                name: "United States",
                currency: "USD",
                system: "progressive",
                brackets: [
                    {min: 0, max: 12550, rate: 10},
                    {min: 12551, max: 50800, rate: 12},
                    {min: 50801, max: 129500, rate: 22},
                    {min: 129501, max: 207600, rate: 24},
                    {min: 207601, max: 518800, rate: 32},
                    {min: 518801, max: 622050, rate: 35},
                    {min: 622051, max: null, rate: 37}
                ]
            },
            "canada": {
                name: "Canada",
                currency: "CAD",
                system: "progressive",
                brackets: [
                    {min: 0, max: 53359, rate: 14.5},
                    {min: 53360, max: 106717, rate: 20.5},
                    {min: 106718, max: 165430, rate: 26},
                    {min: 165431, max: 235675, rate: 29},
                    {min: 235676, max: null, rate: 33}
                ]
            },
            "united_kingdom": {
                name: "United Kingdom",
                currency: "GBP",
                system: "progressive",
                brackets: [
                    {min: 0, max: 12570, rate: 0},
                    {min: 12571, max: 50270, rate: 20},
                    {min: 50271, max: 125140, rate: 40},
                    {min: 125141, max: null, rate: 45}
                ]
            },
            "germany": {
                name: "Germany",
                currency: "EUR",
                system: "progressive",
                brackets: [
                    {min: 0, max: 11604, rate: 0},
                    {min: 11605, max: 17005, rate: 14},
                    {min: 17006, max: 66760, rate: 24},
                    {min: 66761, max: 277825, rate: 42},
                    {min: 277826, max: null, rate: 45}
                ]
            },
            "france": {
                name: "France",
                currency: "EUR",
                system: "progressive",
                brackets: [
                    {min: 0, max: 11294, rate: 0},
                    {min: 11295, max: 28797, rate: 11},
                    {min: 28798, max: 82341, rate: 30},
                    {min: 82342, max: 177106, rate: 41},
                    {min: 177107, max: null, rate: 45}
                ]
            },
            "italy": {
                name: "Italy",
                currency: "EUR",
                system: "progressive",
                brackets: [
                    {min: 0, max: 28000, rate: 23},
                    {min: 28001, max: 50000, rate: 35},
                    {min: 50001, max: null, rate: 43}
                ]
            },
            "spain": {
                name: "Spain",
                currency: "EUR",
                system: "progressive",
                brackets: [
                    {min: 0, max: 12450, rate: 9.5},
                    {min: 12451, max: 20200, rate: 12},
                    {min: 20201, max: 35200, rate: 15},
                    {min: 35201, max: 60000, rate: 18.5},
                    {min: 60001, max: 300000, rate: 22.5},
                    {min: 300001, max: null, rate: 24.5}
                ]
            },
            "sweden": {
                name: "Sweden",
                currency: "SEK",
                system: "progressive",
                brackets: [
                    {min: 0, max: 625800, rate: 32},
                    {min: 625801, max: null, rate: 52}
                ]
            },
            "norway": {
                name: "Norway",
                currency: "NOK",
                system: "progressive",
                brackets: [
                    {min: 0, max: 208050, rate: 22},
                    {min: 208051, max: 292850, rate: 23.7},
                    {min: 292851, max: 670000, rate: 26},
                    {min: 670001, max: 937900, rate: 35.4},
                    {min: 937901, max: null, rate: 39.7}
                ]
            },
            "denmark": {
                name: "Denmark",
                currency: "DKK",
                system: "progressive",
                brackets: [
                    {min: 0, max: 588900, rate: 35.2},
                    {min: 588901, max: null, rate: 55.9}
                ]
            },
            "russia": {
                name: "Russia",
                currency: "RUB",
                system: "progressive",
                brackets: [
                    {min: 0, max: 2400000, rate: 13},
                    {min: 2400001, max: 5000000, rate: 15},
                    {min: 5000001, max: 20000000, rate: 18},
                    {min: 20000001, max: 50000000, rate: 20},
                    {min: 50000001, max: null, rate: 22}
                ]
            },
            "china": {
                name: "China",
                currency: "CNY",
                system: "progressive",
                brackets: [
                    {min: 0, max: 36000, rate: 3},
                    {min: 36001, max: 144000, rate: 10},
                    {min: 144001, max: 300000, rate: 20},
                    {min: 300001, max: 420000, rate: 25},
                    {min: 420001, max: 660000, rate: 30},
                    {min: 660001, max: 960000, rate: 35},
                    {min: 960001, max: null, rate: 45}
                ]
            },
            "india": {
                name: "India",
                currency: "INR",
                system: "progressive",
                brackets: [
                    {min: 0, max: 300000, rate: 0},
                    {min: 300001, max: 700000, rate: 5},
                    {min: 700001, max: 1000000, rate: 10},
                    {min: 1000001, max: 1200000, rate: 15},
                    {min: 1200001, max: 1500000, rate: 20},
                    {min: 1500001, max: null, rate: 30}
                ]
            },
            "japan": {
                name: "Japan",
                currency: "JPY",
                system: "progressive",
                brackets: [
                    {min: 0, max: 1950000, rate: 5},
                    {min: 1950001, max: 3300000, rate: 10},
                    {min: 3300001, max: 6950000, rate: 20},
                    {min: 6950001, max: 9000000, rate: 23},
                    {min: 9000001, max: 18000000, rate: 33},
                    {min: 18000001, max: 40000000, rate: 40},
                    {min: 40000001, max: null, rate: 45}
                ]
            },
            "south_korea": {
                name: "South Korea",
                currency: "KRW",
                system: "progressive",
                brackets: [
                    {min: 0, max: 14000000, rate: 6},
                    {min: 14000001, max: 50000000, rate: 15},
                    {min: 50000001, max: 88000000, rate: 24},
                    {min: 88000001, max: 150000000, rate: 35},
                    {min: 150000001, max: 300000000, rate: 38},
                    {min: 300000001, max: 500000000, rate: 40},
                    {min: 500000001, max: 1000000000, rate: 42},
                    {min: 1000000001, max: null, rate: 45}
                ]
            },
            "singapore": {
                name: "Singapore",
                currency: "SGD",
                system: "progressive",
                brackets: [
                    {min: 0, max: 20000, rate: 0},
                    {min: 20001, max: 30000, rate: 2},
                    {min: 30001, max: 40000, rate: 3.5},
                    {min: 40001, max: 80000, rate: 7},
                    {min: 80001, max: 120000, rate: 11.5},
                    {min: 120001, max: 160000, rate: 15},
                    {min: 160001, max: 200000, rate: 18},
                    {min: 200001, max: 240000, rate: 19},
                    {min: 240001, max: 280000, rate: 19.5},
                    {min: 280001, max: 320000, rate: 20},
                    {min: 320001, max: 500000, rate: 22},
                    {min: 500001, max: 1000000, rate: 23},
                    {min: 1000001, max: null, rate: 24}
                ]
            },
            "thailand": {
                name: "Thailand",
                currency: "THB",
                system: "progressive",
                brackets: [
                    {min: 0, max: 150000, rate: 0},
                    {min: 150001, max: 300000, rate: 5},
                    {min: 300001, max: 500000, rate: 10},
                    {min: 500001, max: 750000, rate: 15},
                    {min: 750001, max: 1000000, rate: 20},
                    {min: 1000001, max: 2000000, rate: 25},
                    {min: 2000001, max: 5000000, rate: 30},
                    {min: 5000001, max: null, rate: 35}
                ]
            },
            "indonesia": {
                name: "Indonesia",
                currency: "IDR",
                system: "progressive",
                brackets: [
                    {min: 0, max: 60000000, rate: 5},
                    {min: 60000001, max: 250000000, rate: 15},
                    {min: 250000001, max: 500000000, rate: 25},
                    {min: 500000001, max: 5000000000, rate: 30},
                    {min: 5000000001, max: null, rate: 35}
                ]
            },
            "australia": {
                name: "Australia",
                currency: "AUD",
                system: "progressive",
                brackets: [
                    {min: 0, max: 18200, rate: 0},
                    {min: 18201, max: 45000, rate: 16},
                    {min: 45001, max: 135000, rate: 30},
                    {min: 135001, max: 190000, rate: 37},
                    {min: 190001, max: null, rate: 45}
                ]
            },
            "south_africa": {
                name: "South Africa",
                currency: "ZAR",
                system: "progressive",
                brackets: [
                    {min: 0, max: 95750, rate: 0},
                    {min: 95751, max: 237100, rate: 18},
                    {min: 237101, max: 370500, rate: 26},
                    {min: 370501, max: 512800, rate: 31},
                    {min: 512801, max: 673000, rate: 36},
                    {min: 673001, max: 857900, rate: 39},
                    {min: 857901, max: 1817000, rate: 41},
                    {min: 1817001, max: null, rate: 45}
                ]
            },
            "nigeria": {
                name: "Nigeria",
                currency: "NGN",
                system: "progressive",
                brackets: [
                    {min: 0, max: 300000, rate: 7},
                    {min: 300001, max: 600000, rate: 11},
                    {min: 600001, max: 1100000, rate: 15},
                    {min: 1100001, max: 1600000, rate: 19},
                    {min: 1600001, max: 3200000, rate: 21},
                    {min: 3200001, max: null, rate: 24}
                ]
            },
            "egypt": {
                name: "Egypt",
                currency: "EGP",
                system: "progressive",
                brackets: [
                    {min: 0, max: 21000, rate: 0},
                    {min: 21001, max: 30000, rate: 2.5},
                    {min: 30001, max: 45000, rate: 10},
                    {min: 45001, max: 200000, rate: 15},
                    {min: 200001, max: 400000, rate: 20},
                    {min: 400001, max: 600000, rate: 22.5},
                    {min: 600001, max: 700000, rate: 25},
                    {min: 700001, max: null, rate: 27.5}
                ]
            },
            "saudi_arabia": {
                name: "Saudi Arabia",
                currency: "SAR",
                system: "zero_personal",
                brackets: [{min: 0, max: null, rate: 0}]
            },
            "united_arab_emirates": {
                name: "United Arab Emirates",
                currency: "AED",
                system: "zero_personal",
                brackets: [{min: 0, max: null, rate: 0}]
            },
            "brazil": {
                name: "Brazil",
                currency: "BRL",
                system: "progressive",
                brackets: [
                    {min: 0, max: 2259.20, rate: 0},
                    {min: 2259.21, max: 2826.65, rate: 7.5},
                    {min: 2826.66, max: 3751.05, rate: 15},
                    {min: 3751.06, max: 4664.68, rate: 22.5},
                    {min: 4664.69, max: null, rate: 27.5}
                ]
            },
            "argentina": {
                name: "Argentina",
                currency: "ARS",
                system: "progressive",
                brackets: [
                    {min: 0, max: 2678400, rate: 0},
                    {min: 2678401, max: 3216000, rate: 5},
                    {min: 3216001, max: 4824000, rate: 9},
                    {min: 4824001, max: 6432000, rate: 12},
                    {min: 6432001, max: 8040000, rate: 15},
                    {min: 8040001, max: 12060000, rate: 19},
                    {min: 12060001, max: 16080000, rate: 23},
                    {min: 16080001, max: 24120000, rate: 27},
                    {min: 24120001, max: 32160000, rate: 31},
                    {min: 32160001, max: null, rate: 35}
                ]
            },
            "mexico": {
                name: "Mexico",
                currency: "MXN",
                system: "progressive",
                brackets: [
                    {min: 0.01, max: 8952.49, rate: 1.92},
                    {min: 8952.50, max: 75984.55, rate: 6.4},
                    {min: 75984.56, max: 133536.07, rate: 10.88},
                    {min: 133536.08, max: 155229.80, rate: 16},
                    {min: 155229.81, max: 185852.57, rate: 21.36},
                    {min: 185852.58, max: 374837.88, rate: 23.52},
                    {min: 374837.89, max: 748737.38, rate: 30},
                    {min: 748737.39, max: 4737272.55, rate: 32},
                    {min: 4737272.56, max: null, rate: 35}
                ]
            }
        };

        // Populate country dropdown
        function populateCountryDropdown() {
            const countrySelect = document.getElementById('country');
            const sortedCountries = Object.entries(taxData).sort((a, b) => a[1].name.localeCompare(b[1].name));
            
            sortedCountries.forEach(([key, data]) => {
                const option = document.createElement('option');
                option.value = key;
                option.textContent = data.name;
                countrySelect.appendChild(option);
            });
        }

        // Update currency when country is selected
        function updateCurrency() {
            const countrySelect = document.getElementById('country');
            const currencyInput = document.getElementById('currency');
            const selectedCountry = countrySelect.value;
            
            if (selectedCountry && taxData[selectedCountry]) {
                currencyInput.value = taxData[selectedCountry].currency;
            } else {
                currencyInput.value = '';
            }
        }

        // Calculate progressive tax
        function calculateProgressiveTax(annualIncome, brackets) {
            let totalTax = 0;
            let remainingIncome = annualIncome;
            
            for (let bracket of brackets) {
                if (remainingIncome <= 0) break;
                
                const bracketMin = bracket.min;
                const bracketMax = bracket.max || Infinity;
                const bracketSize = bracketMax - bracketMin;
                const taxableInThisBracket = Math.min(remainingIncome, bracketSize);
                
                if (annualIncome > bracketMin) {
                    const effectiveTaxableAmount = Math.min(taxableInThisBracket, annualIncome - bracketMin);
                    totalTax += effectiveTaxableAmount * (bracket.rate / 100);
                }
                
                remainingIncome -= taxableInThisBracket;
            }
            
            return totalTax;
        }

        // Main calculation function
        function calculateTax() {
            const salary = parseFloat(document.getElementById('salary').value);
            const countryKey = document.getElementById('country').value;
            
            if (!salary || !countryKey) {
                alert('Please enter a salary and select a country');
                return;
            }
            
            const countryData = taxData[countryKey];
            const annualIncome = salary * 12;
            
            let totalTax = 0;
            
            if (countryData.system === 'zero_personal') {
                totalTax = 0;
            } else if (countryData.system === 'flat') {
                const rate = countryData.brackets[0].rate;
                totalTax = annualIncome * (rate / 100);
            } else {
                totalTax = calculateProgressiveTax(annualIncome, countryData.brackets);
            }
            
            const effectiveRate = (totalTax / annualIncome) * 100;
            const netIncome = annualIncome - totalTax;
            
            // Display results
            document.getElementById('results').style.display = 'grid';
            document.getElementById('grossIncome').textContent = `${countryData.currency} ${annualIncome.toLocaleString()}`;
            document.getElementById('taxAmount').textContent = `${countryData.currency} ${totalTax.toLocaleString()}`;
            document.getElementById('taxRate').textContent = `${effectiveRate.toFixed(2)}%`;
            document.getElementById('netIncome').textContent = `${countryData.currency} ${netIncome.toLocaleString()}`;
            
            // Highlight selected country on map
            document.querySelectorAll('.country').forEach(country => {
                country.classList.remove('selected');
            });
            
            const selectedCountryElement = document.querySelector(`[data-country="${countryKey}"]`);
            if (selectedCountryElement) {
                selectedCountryElement.classList.add('selected');
            }
        }

        // Map interaction
        function setupMapInteraction() {
            const countries = document.querySelectorAll('.country');
            const countryInfo = document.getElementById('countryInfo');
            
            countries.forEach(country => {
                country.addEventListener('mouseenter', (e) => {
                    const countryKey = e.target.getAttribute('data-country');
                    if (taxData[countryKey]) {
                        const data = taxData[countryKey];
                        const topRate = data.brackets[data.brackets.length - 1].rate;
                        
                        countryInfo.innerHTML = `
                            <strong>${data.name}</strong><br>
                            Currency: ${data.currency}<br>
                            System: ${data.system}<br>
                            Top Rate: ${topRate}%
                        `;
                        countryInfo.style.display = 'block';
                    }
                });
                
                country.addEventListener('mousemove', (e) => {
                    countryInfo.style.left = (e.pageX + 10) + 'px';
                    countryInfo.style.top = (e.pageY + 10) + 'px';
                });
                
                country.addEventListener('mouseleave', () => {
                    countryInfo.style.display = 'none';
                });
                
                country.addEventListener('click', (e) => {
                    const countryKey = e.target.getAttribute('data-country');
                    if (taxData[countryKey]) {
                        document.getElementById('country').value = countryKey;
                        updateCurrency();
                        
                        // Auto-calculate if salary is entered
                        const salary = document.getElementById('salary').value;
                        if (salary) {
                            calculateTax();
                        }
                    }
                });
            });
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            populateCountryDropdown();
            setupMapInteraction();
            
            // Add event listeners
            document.getElementById('country').addEventListener('change', updateCurrency);
            document.getElementById('salary').addEventListener('input', function() {
                // Auto-calculate when both salary and country are selected
                const countryKey = document.getElementById('country').value;
                if (this.value && countryKey) {
                    calculateTax();
                }
            });
            
            // Set default country
            document.getElementById('country').value = 'united_states';
            updateCurrency();
        });
    </script>
</body>
</html>