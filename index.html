<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Global Tax Calculator Map</title>

    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
          integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
          crossorigin=""/>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <div class="container">
        <h1>üåç Global Tax Calculator Map</h1>

        <div class="calculator-section">
            <h2>üí∞ Global Tax Comparison Calculator</h2>
            <p>Enter your monthly salary to see how much tax you would pay in different countries around the world.</p>

            <div class="input-group">
                <div class="input-field">
                    <label for="salary">Monthly Salary</label>
                    <input type="number" id="salary" placeholder="Enter your monthly salary" value="700" min="0" step="50">
                </div>

                <div class="input-field">
                    <label for="inputCurrency">Input Currency</label>
                    <select id="inputCurrency">
                        <option value="USD">USD - US Dollar</option>
                        <option value="EUR">EUR - Euro</option>
                        <option value="GBP">GBP - British Pound</option>
                        <option value="JPY">JPY - Japanese Yen</option>
                        <option value="CAD">CAD - Canadian Dollar</option>
                        <option value="AUD">AUD - Australian Dollar</option>
                        <option value="CHF">CHF - Swiss Franc</option>
                        <option value="CNY">CNY - Chinese Yuan</option>
                        <option value="SEK">SEK - Swedish Krona</option>
                        <option value="NOK">NOK - Norwegian Krone</option>
                        <option value="DKK">DKK - Danish Krone</option>
                        <option value="PLN">PLN - Polish Zloty</option>
                        <option value="CZK">CZK - Czech Koruna</option>
                        <option value="HUF">HUF - Hungarian Forint</option>
                        <option value="RON">RON - Romanian Leu</option>
                        <option value="BGN">BGN - Bulgarian Lev</option>
                        <option value="HRK">HRK - Croatian Kuna</option>
                        <option value="RUB">RUB - Russian Ruble</option>
                        <option value="UAH">UAH - Ukrainian Hryvnia</option>
                        <option value="TRY">TRY - Turkish Lira</option>
                        <option value="INR">INR - Indian Rupee</option>
                        <option value="KRW">KRW - South Korean Won</option>
                        <option value="SGD">SGD - Singapore Dollar</option>
                        <option value="HKD">HKD - Hong Kong Dollar</option>
                        <option value="NZD">NZD - New Zealand Dollar</option>
                        <option value="MXN">MXN - Mexican Peso</option>
                        <option value="BRL">BRL - Brazilian Real</option>
                        <option value="ARS">ARS - Argentine Peso</option>
                        <option value="CLP">CLP - Chilean Peso</option>
                        <option value="COP">COP - Colombian Peso</option>
                        <option value="ZAR">ZAR - South African Rand</option>
                        <option value="EGP">EGP - Egyptian Pound</option>
                        <option value="AED">AED - UAE Dirham</option>
                        <option value="SAR">SAR - Saudi Riyal</option>
                        <option value="ILS">ILS - Israeli Shekel</option>
                        <option value="THB">THB - Thai Baht</option>
                        <option value="MYR">MYR - Malaysian Ringgit</option>
                        <option value="IDR">IDR - Indonesian Rupiah</option>
                        <option value="PHP">PHP - Philippine Peso</option>
                        <option value="VND">VND - Vietnamese Dong</option>
                        <option value="PKR">PKR - Pakistani Rupee</option>
                        <option value="BDT">BDT - Bangladeshi Taka</option>
                        <option value="LKR">LKR - Sri Lankan Rupee</option>
                        <option value="MMK">MMK - Myanmar Kyat</option>
                        <option value="KZT">KZT - Kazakhstani Tenge</option>
                        <option value="UZS">UZS - Uzbekistani Som</option>
                        <option value="GEL">GEL - Georgian Lari</option>
                        <option value="AMD">AMD - Armenian Dram</option>
                        <option value="AZN">AZN - Azerbaijani Manat</option>
                        <option value="BYN">BYN - Belarusian Ruble</option>
                        <option value="MDL">MDL - Moldovan Leu</option>
                        <option value="MKD">MKD - North Macedonian Denar</option>
                        <option value="RSD">RSD - Serbian Dinar</option>
                        <option value="BAM">BAM - Bosnia-Herzegovina Mark</option>
                        <option value="ALL">ALL - Albanian Lek</option>
                        <option value="MNT">MNT - Mongolian Tugrik</option>
                        <option value="NGN">NGN - Nigerian Naira</option>
                        <option value="KES">KES - Kenyan Shilling</option>
                        <option value="GHS">GHS - Ghanaian Cedi</option>
                        <option value="ETB">ETB - Ethiopian Birr</option>
                        <option value="UGX">UGX - Ugandan Shilling</option>
                        <option value="TZS">TZS - Tanzanian Shilling</option>
                        <option value="MAD">MAD - Moroccan Dirham</option>
                        <option value="DZD">DZD - Algerian Dinar</option>
                        <option value="TND">TND - Tunisian Dinar</option>
                        <option value="XOF">XOF - West African CFA Franc</option>
                        <option value="XAF">XAF - Central African CFA Franc</option>
                    </select>
                </div>

                <div class="input-field">
                    <label for="displayCurrency">Display Results In</label>
                    <select id="displayCurrency">
                        <option value="USD">USD - US Dollar</option>
                        <option value="EUR">EUR - Euro</option>
                        <option value="GBP">GBP - British Pound</option>
                        <option value="JPY">JPY - Japanese Yen</option>
                        <option value="CAD">CAD - Canadian Dollar</option>
                        <option value="AUD">AUD - Australian Dollar</option>
                        <option value="CHF">CHF - Swiss Franc</option>
                        <option value="CNY">CNY - Chinese Yuan</option>
                        <option value="SEK">SEK - Swedish Krona</option>
                        <option value="NOK">NOK - Norwegian Krone</option>
                        <option value="DKK">DKK - Danish Krone</option>
                        <option value="PLN">PLN - Polish Zloty</option>
                        <option value="CZK">CZK - Czech Koruna</option>
                        <option value="HUF">HUF - Hungarian Forint</option>
                        <option value="RON">RON - Romanian Leu</option>
                        <option value="BGN">BGN - Bulgarian Lev</option>
                        <option value="HRK">HRK - Croatian Kuna</option>
                        <option value="RUB">RUB - Russian Ruble</option>
                        <option value="UAH">UAH - Ukrainian Hryvnia</option>
                        <option value="TRY">TRY - Turkish Lira</option>
                        <option value="INR">INR - Indian Rupee</option>
                        <option value="KRW">KRW - South Korean Won</option>
                        <option value="SGD">SGD - Singapore Dollar</option>
                        <option value="HKD">HKD - Hong Kong Dollar</option>
                        <option value="NZD">NZD - New Zealand Dollar</option>
                        <option value="MXN">MXN - Mexican Peso</option>
                        <option value="BRL">BRL - Brazilian Real</option>
                        <option value="ARS">ARS - Argentine Peso</option>
                        <option value="CLP">CLP - Chilean Peso</option>
                        <option value="COP">COP - Colombian Peso</option>
                        <option value="ZAR">ZAR - South African Rand</option>
                        <option value="EGP">EGP - Egyptian Pound</option>
                        <option value="AED">AED - UAE Dirham</option>
                        <option value="SAR">SAR - Saudi Riyal</option>
                        <option value="ILS">ILS - Israeli Shekel</option>
                        <option value="THB">THB - Thai Baht</option>
                        <option value="MYR">MYR - Malaysian Ringgit</option>
                        <option value="IDR">IDR - Indonesian Rupiah</option>
                        <option value="PHP">PHP - Philippine Peso</option>
                        <option value="VND">VND - Vietnamese Dong</option>
                        <option value="PKR">PKR - Pakistani Rupee</option>
                        <option value="BDT">BDT - Bangladeshi Taka</option>
                        <option value="LKR">LKR - Sri Lankan Rupee</option>
                        <option value="MMK">MMK - Myanmar Kyat</option>
                        <option value="KZT">KZT - Kazakhstani Tenge</option>
                        <option value="UZS">UZS - Uzbekistani Som</option>
                        <option value="GEL">GEL - Georgian Lari</option>
                        <option value="AMD">AMD - Armenian Dram</option>
                        <option value="AZN">AZN - Azerbaijani Manat</option>
                        <option value="BYN">BYN - Belarusian Ruble</option>
                        <option value="MDL">MDL - Moldovan Leu</option>
                        <option value="MKD">MKD - North Macedonian Denar</option>
                        <option value="RSD">RSD - Serbian Dinar</option>
                        <option value="BAM">BAM - Bosnia-Herzegovina Mark</option>
                        <option value="ALL">ALL - Albanian Lek</option>
                        <option value="MNT">MNT - Mongolian Tugrik</option>
                        <option value="NGN">NGN - Nigerian Naira</option>
                        <option value="KES">KES - Kenyan Shilling</option>
                        <option value="GHS">GHS - Ghanaian Cedi</option>
                        <option value="ETB">ETB - Ethiopian Birr</option>
                        <option value="UGX">UGX - Ugandan Shilling</option>
                        <option value="TZS">TZS - Tanzanian Shilling</option>
                        <option value="MAD">MAD - Moroccan Dirham</option>
                        <option value="DZD">DZD - Algerian Dinar</option>
                        <option value="TND">TND - Tunisian Dinar</option>
                        <option value="XOF">XOF - West African CFA Franc</option>
                        <option value="XAF">XAF - Central African CFA Franc</option>
                    </select>
                </div>
            </div>

            <div class="loading-info" id="loadingInfo" style="display: none;">
                <p>üîÑ Fetching exchange rates and calculating taxes for all countries...</p>
            </div>
        </div>

        <div class="map-container">
            <div class="map-header">
                <div class="map-title">
                    <h2>üó∫Ô∏è Interactive Tax Visualization Map</h2>
                    <p>Map colors represent actual tax burden in <span class="currency-display">USD</span>. Click markers for detailed information.</p>
                </div>
                <button id="fullscreenToggle" class="fullscreen-btn" title="Toggle fullscreen map">
                    <span class="expand-icon">‚§¢</span>
                    <span class="contract-icon" style="display: none;">‚§°</span>
                </button>
            </div>

            <!-- Compact input section for fullscreen mode -->
            <div class="fullscreen-inputs" id="fullscreenInputs" style="display: none;">
                <div class="compact-input-group">
                    <div class="compact-input-field">
                        <label for="fullscreenSalary">Monthly Salary</label>
                        <input type="number" id="fullscreenSalary" placeholder="Enter salary" min="0" step="50">
                    </div>
                    <div class="compact-input-field">
                        <label for="fullscreenInputCurrency">Input Currency</label>
                        <select id="fullscreenInputCurrency">
                            <option value="USD">USD</option>
                            <option value="EUR">EUR</option>
                            <option value="GBP">GBP</option>
                            <option value="JPY">JPY</option>
                            <option value="CAD">CAD</option>
                            <option value="AUD">AUD</option>
                            <option value="CHF">CHF</option>
                            <option value="CNY">CNY</option>
                            <option value="SEK">SEK</option>
                            <option value="NOK">NOK</option>
                            <option value="DKK">DKK</option>
                            <option value="PLN">PLN</option>
                            <option value="CZK">CZK</option>
                            <option value="HUF">HUF</option>
                            <option value="RON">RON</option>
                            <option value="BGN">BGN</option>
                            <option value="HRK">HRK</option>
                            <option value="RUB">RUB</option>
                            <option value="UAH">UAH</option>
                            <option value="TRY">TRY</option>
                            <option value="INR">INR</option>
                            <option value="KRW">KRW</option>
                            <option value="SGD">SGD</option>
                            <option value="HKD">HKD</option>
                            <option value="NZD">NZD</option>
                            <option value="MXN">MXN</option>
                            <option value="BRL">BRL</option>
                            <option value="ARS">ARS</option>
                            <option value="CLP">CLP</option>
                            <option value="COP">COP</option>
                            <option value="ZAR">ZAR</option>
                            <option value="EGP">EGP</option>
                            <option value="AED">AED</option>
                            <option value="SAR">SAR</option>
                            <option value="ILS">ILS</option>
                            <option value="THB">THB</option>
                            <option value="MYR">MYR</option>
                            <option value="IDR">IDR</option>
                            <option value="PHP">PHP</option>
                            <option value="VND">VND</option>
                            <option value="PKR">PKR</option>
                            <option value="BDT">BDT</option>
                            <option value="LKR">LKR</option>
                            <option value="MMK">MMK</option>
                            <option value="KZT">KZT</option>
                            <option value="UZS">UZS</option>
                            <option value="GEL">GEL</option>
                            <option value="AMD">AMD</option>
                            <option value="AZN">AZN</option>
                            <option value="BYN">BYN</option>
                            <option value="MDL">MDL</option>
                            <option value="MKD">MKD</option>
                            <option value="RSD">RSD</option>
                            <option value="BAM">BAM</option>
                            <option value="ALL">ALL</option>
                            <option value="MNT">MNT</option>
                            <option value="NGN">NGN</option>
                            <option value="KES">KES</option>
                            <option value="GHS">GHS</option>
                            <option value="ETB">ETB</option>
                            <option value="UGX">UGX</option>
                            <option value="TZS">TZS</option>
                            <option value="MAD">MAD</option>
                            <option value="DZD">DZD</option>
                            <option value="TND">TND</option>
                            <option value="XOF">XOF</option>
                            <option value="XAF">XAF</option>
                        </select>
                    </div>
                    <div class="compact-input-field">
                        <label for="fullscreenDisplayCurrency">Display Currency</label>
                        <select id="fullscreenDisplayCurrency">
                            <option value="USD">USD</option>
                            <option value="EUR">EUR</option>
                            <option value="GBP">GBP</option>
                            <option value="JPY">JPY</option>
                            <option value="CAD">CAD</option>
                            <option value="AUD">AUD</option>
                            <option value="CHF">CHF</option>
                            <option value="CNY">CNY</option>
                            <option value="SEK">SEK</option>
                            <option value="NOK">NOK</option>
                            <option value="DKK">DKK</option>
                            <option value="PLN">PLN</option>
                            <option value="CZK">CZK</option>
                            <option value="HUF">HUF</option>
                            <option value="RON">RON</option>
                            <option value="BGN">BGN</option>
                            <option value="HRK">HRK</option>
                            <option value="RUB">RUB</option>
                            <option value="UAH">UAH</option>
                            <option value="TRY">TRY</option>
                            <option value="INR">INR</option>
                            <option value="KRW">KRW</option>
                            <option value="SGD">SGD</option>
                            <option value="HKD">HKD</option>
                            <option value="NZD">NZD</option>
                            <option value="MXN">MXN</option>
                            <option value="BRL">BRL</option>
                            <option value="ARS">ARS</option>
                            <option value="CLP">CLP</option>
                            <option value="COP">COP</option>
                            <option value="ZAR">ZAR</option>
                            <option value="EGP">EGP</option>
                            <option value="AED">AED</option>
                            <option value="SAR">SAR</option>
                            <option value="ILS">ILS</option>
                            <option value="THB">THB</option>
                            <option value="MYR">MYR</option>
                            <option value="IDR">IDR</option>
                            <option value="PHP">PHP</option>
                            <option value="VND">VND</option>
                            <option value="PKR">PKR</option>
                            <option value="BDT">BDT</option>
                            <option value="LKR">LKR</option>
                            <option value="MMK">MMK</option>
                            <option value="KZT">KZT</option>
                            <option value="UZS">UZS</option>
                            <option value="GEL">GEL</option>
                            <option value="AMD">AMD</option>
                            <option value="AZN">AZN</option>
                            <option value="BYN">BYN</option>
                            <option value="MDL">MDL</option>
                            <option value="MKD">MKD</option>
                            <option value="RSD">RSD</option>
                            <option value="BAM">BAM</option>
                            <option value="ALL">ALL</option>
                            <option value="MNT">MNT</option>
                            <option value="NGN">NGN</option>
                            <option value="KES">KES</option>
                            <option value="GHS">GHS</option>
                            <option value="ETB">ETB</option>
                            <option value="UGX">UGX</option>
                            <option value="TZS">TZS</option>
                            <option value="MAD">MAD</option>
                            <option value="DZD">DZD</option>
                            <option value="TND">TND</option>
                            <option value="XOF">XOF</option>
                            <option value="XAF">XAF</option>
                        </select>
                    </div>
                    <div class="compact-input-field">
                        <button id="fullscreenViewToggle" class="view-toggle-btn" title="Toggle labels view">
                            <span class="grid-icon">‚öè</span>
                            <span class="map-icon" style="display: none;">üó∫</span>
                        </button>
                    </div>
                </div>
            </div>

            <div class="world-map" id="worldMap">
                <div class="map-loading" id="mapLoading">
                    <div class="loading-spinner"></div>
                    <p>Calculating taxes...</p>
                </div>
                <!-- Grid view container -->
                <div class="labels-grid" id="labelsGrid">
                    <!-- Grid cards will be populated here -->
                </div>
            </div>

            <div class="tax-legend">
                <div class="legend-item">
                    <div class="legend-color" style="background-color: #28a745;"></div>
                    <span>Tax Havens (0%)</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background-color: #40c057;"></div>
                    <span>Very Low (‚â§10%)</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background-color: #69db7c;"></div>
                    <span>Low (‚â§20%)</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background-color: #ffeb3b;"></div>
                    <span>Moderate (‚â§30%)</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background-color: #ff9800;"></div>
                    <span>Medium (‚â§40%)</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background-color: #f44336;"></div>
                    <span>High (‚â§50%)</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background-color: #b71c1c;"></div>
                    <span>Highest (>50%)</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background-color: #9e9e9e;"></div>
                    <span>No Calculation</span>
                </div>
            </div>
        </div>

        <!-- Results Table Section -->
        <div class="results-section" id="resultsTableContainer" style="display: none;">
            <div class="results-header">
                <h2>üìä Tax Comparison Results</h2>
                <div class="results-controls">
                    <input type="text" id="countrySearch" class="search-box" placeholder="Search countries...">
                    <button id="exportBtn" class="export-btn">üì• Export CSV</button>
                </div>
            </div>

            <div class="summary-stats">
                <div class="stat-item">
                    <h4>Countries Analyzed</h4>
                    <div class="stat-value" id="totalCountries">0</div>
                </div>
                <div class="stat-item">
                    <h4>Average Tax (<span class="currency-display">USD</span>)</h4>
                    <div class="stat-value" id="avgTax">$0</div>
                </div>
                <div class="stat-item">
                    <h4>Highest Tax</h4>
                    <div class="stat-value" id="maxTax">$0</div>
                </div>
                <div class="stat-item">
                    <h4>Lowest Tax</h4>
                    <div class="stat-value" id="minTax">$0</div>
                </div>
            </div>

            <div class="results-table-container">
                <table class="results-table">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th class="sort-header" data-column="countryName" onclick="window.sortTable('countryName')">
                                Country <span class="sort-indicator">‚Üï</span>
                            </th>
                            <th class="sort-header" data-column="taxAmountInDisplayCurrency" onclick="window.sortTable('taxAmountInDisplayCurrency')">
                                Annual Tax (<span class="currency-display">USD</span>) <span class="sort-indicator">‚Üì</span>
                            </th>
                            <th class="sort-header" data-column="effectiveRate" onclick="window.sortTable('effectiveRate')">
                                Tax Rate <span class="sort-indicator">‚Üï</span>
                            </th>
                            <th class="sort-header" data-column="netIncomeInDisplayCurrency" onclick="window.sortTable('netIncomeInDisplayCurrency')">
                                Net Income (<span class="currency-display">USD</span>) <span class="sort-indicator">‚Üï</span>
                            </th>
                            <th>Local Currency</th>
                            <th>Exchange Rate</th>
                        </tr>
                    </thead>
                    <tbody id="resultsTableBody">
                        <!-- Results will be populated here -->
                    </tbody>
                </table>
            </div>
        </div>

        <div class="disclaimer">
            <strong>üìå Disclaimer:</strong> This calculator provides estimates based on basic income tax brackets for 2024-2025.
            Actual taxes may vary due to deductions, credits, social security contributions, municipal taxes, and other factors.
            Consult a tax professional for accurate calculations. Data covers 146+ countries with progressive, flat, and zero-tax systems.
        </div>
    </div>

    <!-- Leaflet JavaScript -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
            integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
            crossorigin=""></script>

    <!-- Custom JavaScript modules -->
    <script type="module" src="js/currencyDropdown.js"></script>
    <script type="module" src="js/app.js"></script>
</body>
</html>
